/**
 * SnapSmack - Global Public Assets
 * Version: 1.5 - Archive Layout Engine (Proportional Cropped)
 * Handles shortcode parsing [img:ID|size|align] and archive grid modes.
 */

/* 1. GLOBAL ASSET CONTAINER
   -------------------------------------------------------------------------
   Applied to every image injected via shortcode. */
.snapsmack-asset {
    display: block;
    height: auto;
    max-width: 100%;
    margin-top: 25px;
    margin-bottom: 25px;
}

/* 2. SIZE OVERRIDES
   -------------------------------------------------------------------------
   !important is used to ensure these override theme-specific image rules. */

/* Small: 300px width */
.asset-small {
    width: 300px !important;
}

/* Medium: 600px width */
.asset-medium {
    width: 600px !important;
}

/* Full: 100% width */
.asset-full {
    width: 100% !important;
}

/* 3. ALIGNMENT LOGIC
   ------------------------------------------------------------------------- */

/* Left: Text wraps around the right */
.align-left {
    float: left;
    margin-right: 25px;
    margin-bottom: 15px;
}

/* Right: Text wraps around the left */
.align-right {
    float: right;
    margin-left: 25px;
    margin-bottom: 15px;
}

/* Center: No wrapping, centered in container */
.align-center {
    float: none;
    margin-left: auto;
    margin-right: auto;
    clear: both;
}

/* 4. CLEARFIX
   -------------------------------------------------------------------------
   Prevents floated images from overlapping following sections. 
   Targeting standard SnapSmack content containers. */
.description::after, 
.static-content::after, 
.post-content::after {
    content: "";
    display: table;
    clear: both;
}

/* 5. SCRAPER PROTECTION
   ------------------------------------------------------------------------- 
   Applied to the reversed email string injected via core/footer.php.
   Thwarts automated harvesters by presenting gibberish in the source code
   while displaying it correctly for the human eye. */
.reverse-email {
    display: inline-block;
    unicode-bidi: bidi-override;
    direction: rtl;
}

/* 6. ARCHIVE LAYOUT ENGINE
   -------------------------------------------------------------------------
   Three display modes for the archive grid, driven by skin manifest.
   Square = 1:1 cropped | Cropped = clamped aspect | Justified = row-fill

   CROPPED LOGIC:
   - Landscapes wider than 3:2 are clamped to 3:2
   - Portraits taller than 2:3 are clamped to 2:3
   - Anything between keeps natural aspect
   - Portrait cells are scaled down so they don't dominate landscapes.
     A landscape at 3:2 fills the cell. A portrait at 2:3 is displayed
     at ~67% cell width, centered, giving equal visual weight.          */

/* --- SQUARE GRID (default) --- */
/* Columns from --grid-cols (GlobalVibe BROWSE COLUMNS).
   Thumb size from --thumb-width (GlobalVibe THUMBNAIL SIZE).
   Gap from --grid-gap (core vars / GlobalVibe). */
.square-grid {
    display: grid;
    grid-template-columns: repeat(var(--grid-cols, 4), var(--thumb-width, 200px));
    gap: var(--grid-gap, 50px);
    padding: 0;
    justify-content: center;
}
.square-grid .thumb-container {
    position: relative;
    overflow: hidden;
    aspect-ratio: 1 / 1;
}
.square-grid .thumb-link {
    display: block !important;
    width: 100% !important;
    height: 100% !important;
    box-sizing: border-box;
}
.square-grid .thumb-link img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

/* --- CROPPED GRID (clamped aspect, proportional portraits) --- */
.cropped-grid {
    display: grid;
    grid-template-columns: repeat(var(--grid-cols, 4), var(--thumb-width, 200px));
    gap: var(--grid-gap, 50px);
    padding: 0;
    justify-content: center;
}
.cropped-grid .thumb-container {
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
}
/* Landscape default: full cell width, 3:2 max crop */
.cropped-grid .thumb-link {
    display: block !important;
    width: 100% !important;
    overflow: hidden;
    aspect-ratio: 3 / 2 !important;
}
/* Portrait: 2:3 aspect, scaled to ~75% cell width for visual balance */
.cropped-grid .thumb-link.orient-portrait {
    width: 75% !important;
    aspect-ratio: 2 / 3 !important;
}
/* Square: 1:1 aspect, scaled to ~90% cell width */
.cropped-grid .thumb-link.orient-square {
    width: 90% !important;
    aspect-ratio: 1 / 1 !important;
}
.cropped-grid .thumb-link img {
    width: 100% !important;
    height: 100% !important;
    object-fit: cover;
    display: block;
}

/* --- JUSTIFIED GRID (Flickr-style row-fill via fjGallery) --- */
/* Layout computed by fjGallery library. Container is position:relative, */
/* items are position:absolute with top/left/width/height set by JS.    */
/* fjGallery.css handles the core positioning — we just style the items. */
/* width:100% is critical — absolute children don't expand the parent,  */
/* so without it the container shrinks to 0 and fjGallery gets no width.*/
.justified-grid {
    position: relative;
    width: 100%;
}
.justified-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

/* --- Frame reset: prevent skin image_frame_style from bleeding into justified grid --- */
.justified-item,
.justified-item a,
.justified-item img {
    border: none !important;
    box-shadow: none !important;
}

/* --- ARCHIVE RESPONSIVE --- */
@media (max-width: 768px) {
    .square-grid,
    .cropped-grid {
        grid-template-columns: repeat(2, 1fr) !important;
    }
}

/* 7. GALLERY WALL — MOBILE GATE
   -------------------------------------------------------------------------
   Hides the wall nav link on small/touch screens. The wall is a
   desktop-only 3D experience — mobile users get the archive grid. */
@media (max-width: 768px) {
    .wall-nav-item { display: none !important; }
}
